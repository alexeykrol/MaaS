# ============================================================
# MaaS MVP - Environment Variables
# ============================================================
# Этот файл содержит ДВЕ секции:
# 1. AI/DEV MODE - для настройки БД (миграции, создание таблиц)
# 2. APPLICATION MODE - для работы приложения (runtime)
#
# DATABASE_URL используется в обоих режимах!
# ============================================================


# ╔══════════════════════════════════════════════════════════╗
# ║  СЕКЦИЯ 1: AI/DEV MODE (для настройки БД)               ║
# ╚══════════════════════════════════════════════════════════╝
#
# Эти credentials использует AI для:
# - Создания таблиц (CREATE TABLE)
# - Создания триггеров (CREATE TRIGGER)
# - Создания индексов (CREATE INDEX)
# - Загрузки seed данных (INSERT)
# - Выполнения миграций
#
# Команды AI/DEV режима:
#   npm run db:migrate    - Выполнить миграции
#   npm run db:schema     - Только схема
#   npm run db:seeds      - Только данные
#   npm run db:test       - Проверить подключение

# Supabase PostgreSQL Direct Connection
# Где найти: Supabase Dashboard → Settings → Database → Connection string → URI
# Формат: postgresql://postgres:[PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[YOUR-PROJECT-REF].supabase.co:5432/postgres


# ╔══════════════════════════════════════════════════════════╗
# ║  СЕКЦИЯ 2: APPLICATION MODE (runtime приложения)         ║
# ╚══════════════════════════════════════════════════════════╝
#
# Эти credentials использует приложение для:
# - Подключения к БД (чтение/запись данных)
# - Вызовов LLM API (OpenAI)
# - Работы Test Runner, Orchestrator, Agents
#
# Команды APPLICATION режима:
#   npm run dev           - Запуск HTTP сервера
#   npm run orchestrator  - Запуск Orchestrator (LISTEN/NOTIFY)
#   npm run test-runner   - Запуск Test Runner CLI

# Supabase Connection (тот же DATABASE_URL что выше)
# Приложение использует тот же DATABASE_URL для подключения к БД
# Примечание: уже определён выше в секции AI/DEV MODE ↑

# Supabase Project Credentials (для будущего фронтенда)
# Где найти: Supabase Dashboard → Settings → API
#
# ВАЖНО: Эти переменные понадобятся когда добавим фронтенд!
#
# Сейчас (MVP - только backend):
#   - Backend использует DATABASE_URL для прямого PostgreSQL доступа
#   - Test Runner - простой HTML без аутентификации
#   - SUPABASE_URL + ANON_KEY НЕ нужны
#
# Потом (Full App - с фронтендом):
#   - Frontend будет использовать Supabase SDK (Auth, Realtime, RLS)
#   - Backend продолжит использовать DATABASE_URL (LISTEN/NOTIFY)
#   - SUPABASE_URL + ANON_KEY ОБЯЗАТЕЛЬНЫ для фронта
#
# Когда будем добавлять фронт - раскомментируй эти строки:
# SUPABASE_URL=https://[YOUR-PROJECT-REF].supabase.co
# SUPABASE_ANON_KEY=eyJhbGc...

# OpenAI API для LLM запросов
# Где найти: https://platform.openai.com/api-keys
# Создать: Create new secret key
OPENAI_API_KEY=sk-proj-[YOUR-OPENAI-KEY-HERE]

# HTTP Server Configuration
PORT=3000

# Test Runner Configuration
# UUID тестового пользователя (используется в test scenarios)
TEST_USER_ID=00000000-0000-0000-0000-000000000000


# ============================================================
# ВАЖНЫЕ ЗАМЕЧАНИЯ:
# ============================================================
#
# 1. DATABASE_URL используется в ОБОИХ режимах (AI/DEV и APPLICATION)
#
# 2. Безопасность:
#    - Этот файл содержит пароль БД - НЕ коммитить в git!
#    - Добавлен в .gitignore
#    - После миграций можно создать отдельного пользователя для приложения
#
# 3. Альтернатива (более безопасно):
#    - Для AI/DEV: временно дать DATABASE_URL
#    - После миграций: создать read-only пользователя для приложения
#    - Обновить DATABASE_URL на read-only версию
#
# 4. LISTEN/NOTIFY требования:
#    - Для Orchestrator ОБЯЗАТЕЛЬНО нужен прямой PostgreSQL доступ
#    - Supabase REST API НЕ поддерживает LISTEN/NOTIFY
#    - Поэтому используем DATABASE_URL (не anon_key)
#
# ============================================================
